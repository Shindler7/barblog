{% extends "base.html" %}
{% block title %}–ì–ª–∞–≤–Ω–∞—è ‚Äî {{ page.title }}{% endblock %}

{% load wagtailcore_tags wagtailimages_tags %}

{% block content %}
    <div class="container py-3">

        <blockquote class="blockquote text-center mb-5">
            <p class="fs-4 fst-italic mb-2">"Tu ne cede malis, sed contra
                audentior ito."</p>
            <footer class="blockquote-footer text-muted">Virgile</footer>
        </blockquote>

        <div class="text-center mb-5">
            <h1 class="display-5 fw-bold">{{ page.title }}</h1>
            {#            {% if page.intro %}#}
            {#                <p class="lead text-muted">{{ page.intro }}</p>#}
            {#            {% endif %}#}
        </div>

        {# –ü–æ–¥ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –∏ –¥–∞–ª—å–Ω–µ–π—à—É—é –∏–¥–µ—é. #}
        {% if current_books %}
            <section class="my-5 pt-4 border-top">
                <h3 class="h4 mb-4">üìö –°–µ–π—á–∞—Å —á–∏—Ç–∞—é</h3>
                <div class="row g-4">
                    {% for book in current_books %}
                        <div class="col-6 col-md-4 col-lg-3">
                            <div class="card h-100 shadow-sm">
                                {% if book.cover %}
                                    <img src="{{ book.cover.url }}"
                                         class="card-img-top img-fluid"
                                         alt="{{ book.title }}">
                                {% endif %}
                                <div class="card-body">
                                    <h6 class="card-title">{{ book.title }}</h6>
                                    <p class="card-subtitle text-muted small mb-2">{{ book.author }}</p>
                                    {% if book.comment %}
                                        <p class="card-text small">{{ book.comment|truncatechars:100 }}</p>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </section>
        {% endif %}

        <section class="blog-feed">
            {% for post in page.get_children.live.specific|dictsortreversed:"date" %}
                <article class="mb-5 pb-4 border-bottom border-2"
                         style="border-color: #e1e5ea;">
                    <div class="mb-2 text-muted small d-flex align-items-center gap-3">
                        <span class="fw-semibold">{{ post.date }}</span>
                        {% if post.tags.all %}
                            <span>
                        {% for tag in post.tags.all %}
                            <span class="badge rounded-pill bg-secondary-subtle text-dark small">{{ tag }}</span>
                        {% endfor %}
                    </span>
                        {% endif %}
                    </div>

                    <h2 class="h4 mb-3">
                        <a href="{% pageurl post %}"
                           class="text-decoration-none text-body-emphasis">
                            {{ post.title }}
                        </a>
                    </h2>

                    {% if post.hero_image %}
                        <a href="{% pageurl post %}">
                            <img src="{{ post.hero_image.url }}"
                                 class="img-fluid rounded mb-3 shadow-sm"
                                 alt="{{ post.title }}">
                        </a>
                    {% endif %}

                    <p class="text-body-secondary mb-4">{{ post.intro|truncatechars:300 }}</p>

                    <a href="{% pageurl post %}"
                       class="btn btn-sm btn-outline-dark">–ß–∏—Ç–∞—Ç—å ‚Üí</a>
                </article>
            {% empty %}
                <p class="text-center text-muted">–ü–æ–∫–∞ –µ—â—ë –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π.</p>
            {% endfor %}
        </section>

    </div>
{% endblock %}